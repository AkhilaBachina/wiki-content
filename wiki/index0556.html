<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from sugar.fp.nsn-rdnet.net/wiki/index.php?title=FlexiTAF_Software_Development_Guide&action=edit by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 23 Aug 2024 05:17:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<title>Editing FlexiTAF Software Development Guide - SugarWiki</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.21.1" />
<meta name="robots" content="noindex,nofollow" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=FlexiTAF_Software_Development_Guide&amp;action=edit" />
<link rel="edit" title="Edit" href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=FlexiTAF_Software_Development_Guide&amp;action=edit" />
<link rel="shortcut icon" href="http://sugar.fp.nsn-rdnet.net/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="http://sugar.fp.nsn-rdnet.net/wiki/opensearch_desc.php" title="SugarWiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://sugar.fp.nsn-rdnet.net/wiki/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="SugarWiki Atom feed" href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="http://sugar.fp.nsn-rdnet.net/wiki/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 8]><link rel="stylesheet" href="/wiki/skins/common/IE80Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/wiki/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="http://sugar.fp.nsn-rdnet.net/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:7a3748d34e6456ae8d0f053363f745f7 */</style>

<script src="http://sugar.fp.nsn-rdnet.net/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"FlexiTAF_Software_Development_Guide","wgTitle":"FlexiTAF Software Development Guide","wgCurRevisionId":8746,"wgArticleId":1773,"wgIsArticle":false,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":true,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"FlexiTAF_Software_Development_Guide","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,
"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});;},{},{});
/* cache key: wikidb:resourceloader:filter:minify-js:7:a02a7fa766593347c4dbb130a7c3803e */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.edit","mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-FlexiTAF_Software_Development_Guide skin-monobook action-edit">
<div id="globalWrapper">
<div id="column-content"><div id="content" class="mw-body-primary" role="main">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Editing FlexiTAF Software Development Guide</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From SugarWiki</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
		<!-- start content -->
<div id="mw-content-text"><div id="mw-anon-edit-warning">
<p><b>Warning:</b> You are not logged in.
</p>
Your IP address will be recorded in this page's edit history.</div>
<div id="wikiPreview" class="ontop" style="display: none;"></div><form id="editform" name="editform" method="post" action="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=FlexiTAF_Software_Development_Guide&amp;action=submit" enctype="multipart/form-data"><input type='hidden' value="" name="wpSection" />
<input type='hidden' value="20240823045735" name="wpStarttime" />
<input type='hidden' value="20110922070558" name="wpEdittime" />
<input type='hidden' value="" name="wpScrolltop" id="wpScrolltop" />
<input type="hidden" value="d41d8cd98f00b204e9800998ecf8427e" name="wpAutoSummary" /><input type="hidden" value="0" name="oldid" /><input type="hidden" value="text/x-wiki" name="format" /><input type="hidden" value="wikitext" name="model" /><div id="toolbar"></div><textarea tabindex="1" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" lang="en" dir="ltr" name="wpTextbox1">= Introduction =
= Requirements =
= Use cases =
= Design =
[https://sharenet-ims.inside.nokiasiemensnetworks.com/Open/397514123 Tfrm-util design overview]

[https://sharenet-ims.inside.nokiasiemensnetworks.com/Open/397523454 FlexiTAF design overview]
== Domain-model ==
All domain model entities have to follow following rules:
*If entity can be located from somewhere declare inner IMapper interface for it.
*IMapper method arguments should use types which implement QName.
*In static finder method arguments should use types which implement ResourceLocation.
*If entity can locate itself create method '''public static Type find(TypeResourceName name)'''. The method must always return single instance.
*If entity can locate all instances of itself create method '''public static Set&lt;Type> findAll(ResourceLocation loc)'''.
*If entity can locate all names of itself create method '''public static Set&lt;TypeResourceName> findNames()'''.
*If entity instance can be persisted in a way that new entry will be created for each call create method '''public static DataResourceName add(Type instance)'''. The object which was passed as an argument must stay unchanged.
*If entity instance can be persisted in a way that existing entry will be updated create method '''public void save()'''. If instance is "new" save-call is allowed to create new entry, but subsequent calls must only update it.
*If entity can be deleted create method '''public static void delete(TypeResourceName name)'''.
*For IMapper methods you can apply same rules but always append method names with domain type name. For example: '''JobResult findJobResult(DataName name)'''. This is because same repository might implement multiple IMapper interfaces.
== Component ==
*Component is an pluggable object which can perform some actions. Components can have dependencies for each other but circular dependencies must be avoided. Each component defines some interface which other components depend of, for example '''IRepositoryRegistry'''. To make flexitaf able to manage component it needs to implement IComponent-interface. Flexitaf uses Booter to startup and manage components. Components can access dependencies using ComponentRegistry, which is only singleton instance in flexitaf.
== Repository ==
*All repositories must implement IRepository-interface.
*Repositories are managed by RepositoryRegistry, which is controlled by RepositoryRegistryComponent.
*If some data cannot be located from repository and the method is returning collection of data, then method should return empty collection. If the method is returning single value, it should throw DataNotFoundException.
= Testing =
= Building =
==Setting up environment==
*Add following settings to your maven2 config ($HOME/.m2/settings.xml)
   &lt;profiles>
    &lt;profile>
      &lt;id>flexitaf-development&lt;/id>
      &lt;properties>
        &lt;flexitaf.release.filter.properties>/home/&lt;yourname>/flexitaf-dev/dev.filter.properties&lt;/flexitaf.release.filter.properties>
      &lt;/properties>
    &lt;/profile>
  &lt;/profiles>
  &lt;activeProfiles>
    &lt;activeProfile>flexiaf5-env&lt;/activeProfile>
  &lt;/activeProfiles>

*Create necessary databases. Easiest way to create necessary databases is to execute following scripts. You can also use same scripts when you want to update your development database to new schema. (Note that scripts expect to find flexitaf sourcecodes from $HOME/flexitaf. You should create symlink there which points to your local copy):
 sh /opt/flexitaf-dev/update_webprofiledb_schema.sh
 sh /opt/flexitaf-dev/update_jobdb_schema.sh
 sh /opt/flexitaf-dev/update_resultdb_schema.sh
 sh /opt/flexitaf-dev/update_targetdb_schema.sh

*Place testcases to /localhome/&lt;username>/testcases

*Create /home/&lt;yourname>/flexitaf-dev/dev.filter.properties and modify them for your needs. These are used to customized configuration files when flexitaf-server assembly is being created. You can have any amount of properties. Just remember that the incrementing count must start from 30.
 development.properties=wrapper.java.additional.30=-Dcom.nokia.flexi.flexitaf.repository.path=/localhome/&lt;yourname>/testcases\n\
 wrapper.java.additional.31=-Dcom.nokia.flexi.flexitaf.results.path=/localhome/&lt;yourname>/results\n\
 wrapper.java.additional.32=-Dtfrm.datasource.target.url=jdbc:mysql://localhost/&lt;yourname>_flexitaf_target\n\
 wrapper.java.additional.33=-Dtfrm.datasource.result.url=jdbc:mysql://localhost/&lt;yourname>_flexitaf_result\n\
 wrapper.java.additional.34=-Dtfrm.datasource.user=&lt;yourname>\n\
 wrapper.java.additional.35=-Dtfrm.datasource.password=password\n\
 wrapper.java.additional.36=-Dtfrm.datasource.driver=com.mysql.jdbc.Driver\n\
 wrapper.java.additional.37=-Dcom.nokia.flexi.flexitaf.scheduler.quartz.url=jdbc:mysql://localhost/&lt;yourname>_flexitaf_job\n\
 wrapper.java.additional.38=-Dcom.nokia.flexi.flexitaf.scheduler.quartz.username=&lt;yourname>\n\
 wrapper.java.additional.39=-Dcom.nokia.flexi.flexitaf.scheduler.quartz.password=password\n\
 wrapper.java.additional.40=-Dcom.nokia.flexi.tfrm.util.config.configFilePath=/opt/flexitaf-dev/flexitaf.xml\n\
 wrapper.java.additional.41=-Djava.util.logging.config.file=/home/&lt;yourname>/flexitaf-dev/flexitaf.logging.properties\n\
 wrapper.java.additional.42=-Dcom.nokia.flexi.flexitaf.webui.database.name=&lt;yourname>_flexitaf_web\n\
 wrapper.java.additional.43=-Dflexitaf.component.jmx.rmi-registry-port=&lt;your port>\n\
 wrapper.java.additional.44=-Djetty.port=&lt;your port>\n\
 wrapper.java.additional.45=-Dcom.nokia.flexi.tfrm.util.hibernate.jmx=false\n\
 wrapper.java.additional.46=-Dcom.nokia.flexi.flexitaf.component.jmx.enabled=false\n\
 wrapper.java.additional.47=-Dcom.nokia.flexi.flexitaf.booter.jmx.enabled=false


*Create /home/&lt;yourname>/flexitaf-dev/flexitaf.logging.properties. This are used by flexitaf-server. For example:
 handlers= java.util.logging.ConsoleHandler
 .level= INFO
 java.util.logging.ConsoleHandler.level = FINEST
 java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter
 com.nokia.flexi.flexitaf.level = ALL
 com.nokia.flexi.flexitaf.datamanager.level = INFO

==Profiles==
*You should always enable flexitaf-dev profile when developing flexitaf. Following global properties are used:
**com.nokia.flexi.tfrm.util.config.configFilePath: Specifies default location for flexitaf config file used during testing.
*Remember to also enable the host specific profile where you are developing flexitaf.

==Building flexitaf-server assembly==
*To build development assembly:
 cd tfrm/flexitaf/flexitaf-modules/flexitaf-server/trunk
 
 mvn clean assembly:directory -Pflexitaf-development,full-release
*You can also use other profiles. Usable distribution profiles are:
 build-provider-release
 full-release
 no-webui-release
*Remember that -Pflexitaf-development property should never be used when constructing real releases

===Creating source package of external dependencies===
*Package can be created with '''package-ext-dep-sources'''-profile
 mvn compile -Pfull-release,package-ext-dep-sources
*Dependencies are included based on the used distribution-profile.

==Building flexitaf-cli assembly==
*To build assembly:
 cd tfrm/flexitaf/flexitaf-modules/flexitaf-cli/trunk/
 
 mvn clean assembly:directory

==Running flexitaf-server==
*First build an assembly. From there you can find necessary scripts to start the server. For example with no-webui release in flexiaf5 you would start up server with following command:
 ./target/flexitaf-server-1.1.0-SNAPSHOT-no-webui-release.dir/flexitaf-server-1.1.0-SNAPSHOT/bin/linux-x86-64/flexitaf console
*From flexitaf.xml you can define what components will be started:
    &lt;flexitaf>
        &lt;booter>
            &lt;components>
                &lt;component name="Scheduler" class="com.nokia.flexi.flexitaf.scheduler.SchedulerComponent"/>
                &lt;component name="BuildProvider" class="com.nokia.flexi.flexitaf.buildprovider.component.BuildProviderComponent"/>
            &lt;/components>
        &lt;/booter>
    &lt;/flexitaf>
*Remember that all you control settings by editing your dev.filter.properties and then recreating assembly.
*Typical process when you fix some bug and want to test it is to
 1) Install fixed component using mvn install
 2) Recreate flexitaf-server assembly
 3) Run start script

==Running flexitaf-webui==
*Follow instruction of flexitaf-server building [[FlexiTAF_Software_Development_Guide#Building_flexitaf-server_assembly]] and running it[[FlexiTAF_Software_Development_Guide#Running_flexitaf-server]].
*Create symlinks to your public_html which points to webui-module, testcases and results. For example:
 mkdir -p $HOME/public_html
 ln -s $HOME/flexitaf/flexitaf-modules/flexitaf-server/trunk/target/flexitaf-server-1.2.1-SNAPSHOT-full-release.dir/flexitaf-server-1.2.1-SNAPSHOT/modules/webui $HOME/public_html/flexitaf
 ln -s /localhome/$USER/testcases $HOME/public_html/testcases
 ln -s /localhome/$USER/results $HOME/public_html/results
*Create .htaccess file to $HOME/public_html/
 AuthName "FlexiTAF WebUI"
 AuthType Basic
 AuthUserFile "/etc/odyssey_passwd"
 AuthGroupFile "/etc/odyssey_groups"
 require group twausers
*Change your flexitaf-server-&lt;version>-SNAPSHOT configuration:
 Change JETTY_PORT value in conf/webuidefault.php to the same value as in your dev.filter.properties file.
 Create "logs" directory if you want wrapper and webui logs to be created. Give write access to apache or just "chmod a+w logs".
 Change wrapper.conf (optional). In flexiaf5 you can enable 64bit stuff like in sugar.

==Running flexitaf-cli==
*First build an assembly. From there you can find necessary scripts to start the client. For example:
 target/flexitaf-cli-1.1.0-SNAPSHOT-release.dir/flexitaf-cli-1.1.0-SNAPSHOT/bin/linux/afcli --configfile /opt/flexiaf-dev/flexitaf_cli_user.xml
*You can control settings by exporting following environment variables:
 FLEXITAF_CLI_OPTS (parameters passed to Java)
 FLEXITAF_CLI_PROPS (properties passed to Java)
*Usually it is good idea to create a script to $HOME/flexitaf-dev and source it whenever you are debugging something with AFCLI.

==Running flexitaf-updatemanager==
*Follow the instructions how to build flexitaf-server assembly. From there you can find necessary start scripts. For example:
 ./target/flexitaf-server-1.1.0-SNAPSHOT-no-webui-release.dir/flexitaf-server-1.1.0-SNAPSHOT/bin/linux-x86-64/updatemanager
*You can control settings by exporting following environment variables:
 FLEXITAF_OPTS (parameters passed to Java)
 FLEXITAF_PROPS (properties passed to Java)
*Usually it is good idea to create a script to $HOME/flexitaf-dev and source it whenever you are debugging something with UpdateManager.

==Running Klocwork Insight for static code analysis==
*Plugin should be present in the list of build-plugins in the pom.xml (if present in parent pom, will be available for all child poms)

   &lt;build>
      ...
      &lt;plugins>
         ...
         &lt;plugin>
            &lt;groupId>com.klocwork.ps&lt;/groupId>
            &lt;artifactId>maven-klocwork-plugin&lt;/artifactId>
            &lt;version>3.0.21&lt;/version>
         &lt;/plugin>
      &lt;/plugins>
   &lt;/build>

*Steps to run the analysis
**kwcheck create --license-host eseelic050.emea.nsn-net.net --license-port 27018  (Once in each component - for each user)
**mvn klocwork:analysis
**kwcheck list

==Useful information==
*All intergration test execution should be placed in integration-tests profile. It means that they should be only executed when you explicitly enable that profile.
*Unit tests can be skipped with -Ddisable-testing property
 mvn install -Ddisable-testing
*For more info check [[Maven_Guide]]
=Maintenance=
==Overall release process==
*Prepare environment for beta testing to flexiaf3
**Install latest flexitaf-server, flexitaf-cli snapshots to flexiaf3
**Install build-provider snapshot to Linsee: esling04 (SVN)
***Use following ports: rmi-registry-port=20010, rmi-interface-port=20009
**Inform people who would like to test something before release that the flexiaf3 environment is ready
*Repeat beta testing until all regressions are fixed
*Ensure that provided config templates are up-to-date
*Update all documentation: TCExec user guide, FlexiTAF user guide, FlexiTAF admin guide
*Release documentation and put PDFs to /twafs/utilities/flexitaf/x.x.x/
*Write release notes (/twafs/utilities/flexitaf/flexitaf/x.x.x/release-notes.txt) describing
**Fixed issues
**Backwards incompatibilities (not API level). (Not yet done in previous release notes)
**External tool dependency updates, for example if FlexiTAF now is compatible with Robot 2.1.1 and Selenium 1.1.0.
**Necessary config changes for admin and user
*Release FlexiTAF [[FlexiTAF_Software_Development_Guide#Releasing_FlexiTAF]]
*Close milestones and create new ones for the next release.
*Store installation bundles to /twafs/utilities/flexitaf/x.x.x.
*Inform about maintenance break (usually 1h is enough) to FP users few days earlier. Also mention which services are offline.
*Some tasks can be performed before maintenance break to make it shorter:
**Update flexitaf-client to flexiaf1,2,7(/opt/flexitaf-cli-...) and linsee hosts (/home/sanman/flexitaf/flexitaf-cli-...)
***Fix config file (diff it to the previous config file and check what needs to be changed -)
***Don't fix symlinks (/usr/local/bin/afcli) yet to point to the latest installation.
**Update flexitaf-server to sugar
***Fix config file (diff it to the previous config file and check what needs to be changed - remember to change the tcexec version, if there is a new version in the new release)
***Update wrapper.conf(diff it to the previous config file and check what needs to be changed)
***Don't yet touch /etc/profile, nor move flexitaf-server work-dir.
**Update flexitaf-build-provider to used Linsee servers
***Installations are in /home/sanman/flexitaf
***Fix config files (wrapper.conf, *_flexitaf.xml, *.logging.properties)
***Diff previously used starter scripts to latest scripts in install dir and copy or make changes
***Create logs directory under flexitaf-server-&lt;version>
***Don't yet restart it
**If new JDK is available, update it also to flexiaf1,2,7 and sugar (JDK6u10 or later).
**If new MySQL is available, fetch RPMs to Sugar. Don't yet install them.
**If new flexitaf-server requires new versions of some external tools (HIT, Robot, Selenium) prepare these. Don't yet take them into use.
*Just before the starting of the maintenence break, apply for a new passowrd for flexitaf functional account, and update the same in the config file, for QC Connectivity
*Start maintenance break
**Sugar
***Enable FlexiTAF maintenance break redirect from httpd.conf and reload (service httpd reload)
***Edit httpd.conf back to original for next restart
**flexiaf1,2,7
***Replace afcli with maintenance script link (ln -sf /twafs/utilities/flexitaf/afcli_maint_break.sh /usr/local/bin/afcli)
***Update JDK if needed
**Sugar
***Shutdown flexitaf-server (service flexitaf stop)
***Shutdown svn mirror script (service svnmirrord stop)
***Shutdown svn update script (service svnupdated stop)
***Delete old jobs from MySQL job db. "use flexitaf_jobs; delete from QRTZ_SIMPLE_TRIGGERS; delete from QRTZ_TRIGGERS; delete from QRTZ_JOB_DETAILS". (Not needed if quartz scheduler is not being used)
***Move work-dir from old install dir to new install dir. (Do not do copy, do move)
***Delete old job cache dirs from: $FLEXITAF_SERVER_PATH/work/job-cache
***Change the owner of the directories to flexitaf (chown -R flexitaf.twausers setup modules lib bin conf )
***Fix /etc/profile paths
***Fix symlinks in /wwwroot/secure
***Fix svn update script (/twafs/utilities/svnupdate/update_*.sh) paths. (For this step, su to twaroot.Then su back to root)
***Run the upgrade script
****su flexitaf
****cd /opt/flexitaf-server-1.6.3/setup/linux/
****sh upgrade.sh
***Update MySQL and JDK if needed
***Update external tools
**Used linsee servers (Details in [[TFRM_Admin_guide#FlexiTAF_Server]])
***Update /home/sanman/flexitaf/cli-env.sh
***Update env scripts: /home/sanman/flexitaf/env_linsee...
***Source first required env script: env_linsee_cc.sh or env_linsee_svn.sh under /home/sanman/flexitaf/
***Stop running build-provider instances from old install dir.
***Go to new install dir and start it up
**Sugar
***Restart HTTPD and remove session data (rm /tmp/sess*)
***Start flexitaf-server. Trace the logs for restart or unexpected errors.
***Start svn update
***Start svn mirror
**flexiaf1,2,7
***update /etc/profile path, if required
***Update symlink /usr/local/bin/afcli
***Go to flexiaf1 and check does "afcli list releases" work. If it does then check "afcli -t Rivendell -u root -p rivendell -r 4.charm exec TEST_ANALYZE_001"
*Fix /twafs/utilities/flexitaf/latest symlink and update FlexiTAF links in Sugar main page.
*Inform users that maintenance break is over
*Fix /twafs/backups/server/script/*.lst files
*If there are problems with new installation then fix the issue and create bugfix release (doesn't require any tags to SVN for them).
*Update FlexiTAF wiki (http://wikis.inside.nokiasiemensnetworks.com/bin/view/Main/FlexiTAF)
*Inform other FlexiTAF users (NSN COO RTP PD SVSS FlexiTAF Announce List) that new release is available with links to installation packages and docs.

*Some trouble shooting steps
**If "out of memory error is shown"
***Check if wrapper.conf has the correct memory settings 
***If flexitaf still does not start, set the result loading threshold (first-job-result-id ) to a higher value to omit older results 
**If Deadlock occurs
***Check whether httpd service is running properly
**If the below error occurs during start flexitaf service, ignore it
***Fatal server error:Server is already active for display 2,If this server is no longer running, remove /tmp/.X2-lock and start again.

==Releasing FlexiTAF==
*Check common release instruction from [[Maven_Guide]]
*Release projects in following order (if some of them has been changed):
**flexitaf-parent
***Using following instructions [[Maven_Guide#Release_single_component]]
**flexitaf-core
***Check initial instructions [[Maven_Guide#Releasing_multi-module_project]]
**flexitaf-shared
***Using following instructions for parent [[Maven_Guide#Releasing_parent_artifact_individually]]
***Using following instructions for components [[Maven_Guide#Release_single_component]]
**flexitaf-modules
***Using following instructions [[Maven_Guide#Release_single_component]]
***And following for flexitaf-webui [[Maven_Guide#Releasing_multi-module_project]]

*When we have release all components we still need to build installation packages. First go to the created flexitaf-server tag directory and
 mvn clean assembly:assembly -Prelease-debug,full-release
 mvn clean assembly:assembly -Prelease-debug,build-provider-release
*Copy created archives to /twafs/utilities/flexitaf/x.y.z
*After flexitaf-server has been bundled you still need create installation package for flexitaf-cli. Go to the created flexitaf-cli tag directory and
 mvn assembly:assembly -Prelease-debug
*Copy created archives to /twafs/utilities/flexitaf/x.y.z
*Release user guides from PI and copy then the same location with archives. TODO: add further instructions later how to export PDFs from PI.

=Debugging=

==Profiling==
*Follow the  basic instruction for profiling [[Maven_Guide#AOP_profiles]]

===flexitaf-cli===
*Follow the basic instruction for running flexitaf-cli [[FlexiTAF_Software_Development_Guide#Running_flexitaf-cli ]].
*Export following additional properties (note paths might vary):
**export FLEXITAF_CLI_OPTS=-javaagent:target/flexitaf-cli-1.3.0-SNAPSHOT-release.dir/flexitaf-cli-1.3.0-SNAPSHOT/lib/aspectjweaver-1.5.4.jar
**export FLEXITAF_CLI_PROPS=-Dorg.aspectj.tracing.factory=default

===flexitaf-server===
*Follow the basic instruction for running flexitaf-server [[FlexiTAF_Software_Development_Guide#Running_flexitaf-server]].
*Add following additional property to your 'enable-runtime-profiling' profile:
 &lt;profile>
   &lt;id>enable-runtime-profiling&lt;/id>
   &lt;properties>
     &lt;tfrm.aop.config>/home/a4virtan/flexiaf-dev/aop-runtime-profiling.xml&lt;/tfrm.aop.config>
     &lt;flexitaf.release.filter.properties>/home/a4virtan/flexiaf-dev/dev-prof.filter.properties&lt;/flexitaf.release.filter.properties>
   &lt;/properties>
 &lt;/profile>
*dev-prof.filter.properties should have same content as dev.filter.properties but it has also two additional properties:
**wrapper.java.additional.33=-javaagent:../../lib/aspectjweaver-1.5.4.jar\n\
**wrapper.java.additional.34=-Dorg.aspectj.tracing.factory=default\n\

== JMX ==
*FlexiTAF can be monitored using standard JMX-client, for example JConsole. You can reload configuration and restart components using exported MBeans. First following component needs to be configured
 &lt;component name="JMXConnectorServer" class="com.nokia.flexi.flexitaf.component.jmx.JMXComponent">
   &lt;configuration url="service:jmx:rmi:///jndi/rmi://:3000/jmxrmi" rmi-registry-port="3000"/>
 &lt;/component>
*url-attribute defines the end-point where we can connect with JMX-client
 jconsole service:jmx:rmi:///jndi/rmi://:3000/jmxrmi
=== Hibernate ===
*Hibernate JMX services can be also exported. In dev.filter.properties you need to have following setting
 wrapper.java.additional.33=-Dcom.nokia.flexi.tfrm.util.hibernate.jmx=true\n\
*Furthermore you need to enable statistics collection in the database hibernate configuration (hibernate.cfg.xml)
 &lt;property name="generate_statistics">true&lt;/property>
*When starting jconsole you need to have hibernate JAR in classpath
 jconsole -J-Djava.class.path=$HOME/.m2/repository/org/hibernate/hibernate/3.2.6.ga/hibernate-3.2.6.ga.jar:$JAVA_HOME/lib/tools.jar:$JAVA_HOME/lib/jconsole.jar service:jmx:rmi:///jndi/rmi://:3000/jmxrmi

=Further development=
*Check tickets from [http://sugar/secure/trac/tfrm Trac]

==Refactoring tasks==
</textarea><div class='editOptions'>
<span class="mw-summary" id="wpSummaryLabel"><label for="wpSummary">Summary:</label></span> <input class="mw-summary" id="wpSummary" maxlength="200" tabindex="1" size="60" spellcheck="true" title="Enter a short summary [b]" accesskey="b" name="wpSummary" /><div class='editCheckboxes'>
</div>
<div id="editpage-copywarn">
<p>Please note that all contributions to SugarWiki may be edited, altered, or removed by other contributors.
If you do not want your writing to be edited mercilessly, then do not submit it here.<br />
You are also promising us that you wrote this yourself, or copied it from a public domain or similar free resource (see <a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=SugarWiki:Copyrights&amp;action=edit&amp;redlink=1" class="new" title="SugarWiki:Copyrights (page does not exist)">SugarWiki:Copyrights</a> for details).
<b>Do not submit copyrighted work without permission!</b>
</p>
</div>
<div class='editButtons'>
<input id="wpSave" name="wpSave" type="submit" tabindex="3" value="Save page" accesskey="s" title="Save your changes [s]" />
<input id="wpPreview" name="wpPreview" type="submit" tabindex="4" value="Show preview" accesskey="p" title="Preview your changes, please use this before saving! [p]" />

<input id="wpDiff" name="wpDiff" type="submit" tabindex="5" value="Show changes" accesskey="v" title="Show which changes you made to the text [v]" />
	<span class='cancelLink'><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/FlexiTAF_Software_Development_Guide" title="FlexiTAF Software Development Guide" id="mw-editform-cancel">Cancel</a> | </span>
	<span class='editHelp'><a target="helpwindow" href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/Help:Editing">Editing help</a> (opens in new window)</span>
</div><!-- editButtons -->
</div><!-- editOptions -->

<input type="hidden" value="+\" name="wpEditToken" />
<div class="mw-editTools"></div>
<div class="templatesUsed"></div><div class="hiddencats"></div>
</form>
</div><div class="printfooter">
Retrieved from "<a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/FlexiTAF_Software_Development_Guide">http://sugar.fp.nsn-rdnet.net/wiki/index.php/FlexiTAF_Software_Development_Guide</a>"</div>
		<div id='catlinks' class='catlinks catlinks-allhidden'></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<h2>Navigation menu</h2>
	<div id="p-cactions" class="portlet" role="navigation">
		<h3>Views</h3>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/FlexiTAF_Software_Development_Guide" primary="1" context="subject" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=Talk:FlexiTAF_Software_Development_Guide&amp;action=edit&amp;redlink=1" primary="1" context="talk" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-edit" class="selected"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=FlexiTAF_Software_Development_Guide&amp;action=edit" primary="1" title="You can edit this page. Please use the preview button before saving">Edit</a></li>
				<li id="ca-history"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=FlexiTAF_Software_Development_Guide&amp;action=history" rel="archives" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal" role="navigation">
		<h3>Personal tools</h3>
		<div class="pBody">
			<ul>
				<li id="pt-anonuserpage"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/User:10.143.81.182" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">10.143.81.182</a></li>
				<li id="pt-anontalk"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/User_talk:10.143.81.182" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li>
				<li id="pt-createaccount"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=Special:UserLogin&amp;returnto=FlexiTAF+Software+Development+Guide&amp;returntoquery=action%3Dedit&amp;type=signup">Create account</a></li>
				<li id="pt-anonlogin"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=Special:UserLogin&amp;returnto=FlexiTAF+Software+Development+Guide&amp;returntoquery=action%3Dedit" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo" role="banner">
<a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/Main_Page" style="background-image: url(http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/wiki.png);" title="Visit the main page"></a>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-portal"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/SugarWiki:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-currentevents"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/SugarWiki:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet" role="search">
		<h3><label for="searchInput">Search</label></h3>
		<div id="searchBody" class="pBody">
			<form action="http://sugar.fp.nsn-rdnet.net/wiki/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search SugarWiki [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb" role="navigation">
		<h3>Toolbox</h3>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/Special:WhatLinksHere/FlexiTAF_Software_Development_Guide" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/Special:RecentChangesLinked/FlexiTAF_Software_Development_Guide" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
				<li id="t-specialpages"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-info"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php?title=FlexiTAF_Software_Development_Guide&amp;action=info">Page information</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer" role="contentinfo">
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="privacy"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/SugarWiki:Privacy_policy" title="SugarWiki:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/SugarWiki:About" title="SugarWiki:About">About SugarWiki</a></li>
		<li id="disclaimer"><a href="http://sugar.fp.nsn-rdnet.net/wiki/index.php/SugarWiki:General_disclaimer" title="SugarWiki:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest","mediawiki.hidpi"], null, true);
}</script>
<script>if(window.mw){
mw.loader.using("mediawiki.action.edit", function() {mw.toolbar.addButton("http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/button_bold.png", "Bold text", "\'\'\'", "\'\'\'", "Bold text", "mw-editbutton-bold");
mw.toolbar.addButton("http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/button_italic.png", "Italic text", "\'\'", "\'\'", "Italic text", "mw-editbutton-italic");
mw.toolbar.addButton("http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/button_link.png", "Internal link", "[[", "]]", "Link title", "mw-editbutton-link");
mw.toolbar.addButton("http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/button_extlink.png", "External link (remember http:// prefix)", "[", "]", "http://www.example.com link title/", "mw-editbutton-extlink");
mw.toolbar.addButton("http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/button_headline.png", "Level 2 headline", "\n== ", " ==\n", "Headline text", "mw-editbutton-headline");
mw.toolbar.addButton("http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/button_nowiki.png", "Ignore wiki formatting", "\x3cnowiki\x3e", "\x3c/nowiki\x3e", "Insert non-formatted text here", "mw-editbutton-nowiki");
mw.toolbar.addButton("http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/button_sig.png", "Your signature with timestamp", "--~~~~", "", "", "mw-editbutton-signature");
mw.toolbar.addButton("http://sugar.fp.nsn-rdnet.net/wiki/skins/common/images/button_hr.png", "Horizontal line (use sparingly)", "\n----\n", "", "", "mw-editbutton-hr");

// Create button bar
$(function() { mw.toolbar.init(); } );
});
}</script>
<script src="http://sugar.fp.nsn-rdnet.net/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<!-- Served in 0.255 secs. --></body>
<!-- Mirrored from sugar.fp.nsn-rdnet.net/wiki/index.php?title=FlexiTAF_Software_Development_Guide&action=edit by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 23 Aug 2024 05:17:48 GMT -->
</html>